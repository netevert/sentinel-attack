{
    "analytics": [
      {
        "displayName": "Console History",
        "description": "Checks for execution of MITRE ATT&CK T0000",
        "severity": "Medium",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"Get-History\"  or process_command_line contains \"AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\PowerShell\\\\PSReadline\\\\ConsoleHost_history.txt\"  or process_command_line contains \"(Get-PSReadlineOption).HistorySavePath\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Named Pipes",
        "description": "Checks for execution of MITRE ATT&CK T0000",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 17 and (pipe_name contains \"\\\\isapi_http\" or pipe_name contains \"\\\\isapi_dg\" or pipe_name contains \"\\\\isapi_dg2\" or pipe_name contains \"\\\\isapi_http\" or pipe_name contains \"\\\\sdlrpc\" or pipe_name contains \"\\\\aheec\" or pipe_name contains \"\\\\winsession\" or pipe_name contains \"\\\\lsassw\" or pipe_name contains \"\\\\rpchlp_3\" or pipe_name contains \"\\\\NamePipe_MoreWindows\" or pipe_name contains \"\\\\pcheap_reuse\" or pipe_name contains \"\\\\PSEXESVC\" or pipe_name contains \"\\\\PowerShellISEPipeName_\" or pipe_name contains \"\\\\csexec\" or pipe_name contains \"\\\\paexec\" or pipe_name contains \"\\\\remcom\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Named Pipes - CobaltStrike",
        "description": "Checks for execution of MITRE ATT&CK T0000",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 17 and pipe_name contains \"\\\\msagent_\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Remotely Query Login Sessions - Network",
        "description": "Checks for execution of MITRE ATT&CK T0000",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and process_path contains \"qwinsta.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Remotely Query Login Sessions - Process",
        "description": "Checks for execution of MITRE ATT&CK T0000",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"qwinsta.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Suspicious filename used",
        "description": "Checks for execution of MITRE ATT&CK T0000",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path == \"a.exe\" or process_path == \"b.exe\" or process_path == \"c.exe\" or process_path == \"d.exe\" or process_path == \"e.exe\" or process_path == \"f.exe\" or process_path == \"g.exe\" or process_path == \"h.exe\" or process_path == \"i.exe\" or process_path == \"j.exe\" or process_path == \"k.exe\" or process_path == \"l.exe\" or process_path == \"m.exe\" or process_path == \"n.exe\" or process_path == \"o.exe\" or process_path == \"p.exe\" or process_path == \"q.exe\" or process_path == \"r.exe\" or process_path == \"s.exe\" or process_path == \"t.exe\" or process_path == \"u.exe\" or process_path == \"v.exe\" or process_path == \"w.exe\" or process_path == \"x.exe\" or process_path == \"y.exe\" or process_path == \"z.exe\" or process_path == \"1.exe\" or process_path == \"2.exe\" or process_path == \"3.exe\" or process_path == \"4.exe\" or process_path == \"5.exe\" or process_path == \"6.exe\" or process_path == \"7.exe\" or process_path == \"8.exe\" or process_path == \"9.exe\" or process_path == \"0.exe\" or process_path == \"10.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Data Compressed",
        "description": "Checks for execution of MITRE ATT&CK T1002",
        "severity": "Medium",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"powershell.exe\"  and process_command_line contains \"-Recurse | Compress-Archive\")  or (process_path contains \"rar.exe\"  and process_command_line contains \"rar*a*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Credential Dumping ImageLoad",
        "description": "Checks for execution of MITRE ATT&CK T1003",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 7 and (module_loaded contains \"C:\\\\Windows\\\\System32\\\\samlib.dll\" or module_loaded contains \"C:\\\\Windows\\\\System32\\\\WinSCard.dll\" or module_loaded contains \"C:\\\\Windows\\\\System32\\\\cryptdll.dll\" or module_loaded contains \"C:\\\\Windows\\\\System32\\\\hid.dll\" or module_loaded contains \"C:\\\\Windows\\\\System32\\\\vaultcli.dll\") and (process_path !contains \"\\\\Sysmon.exe\" or process_path !contains \"\\\\svchost.exe\" or process_path !contains \"\\\\logonui.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Credential Dumping - Process",
        "description": "Checks for execution of MITRE ATT&CK T1003",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"Invoke-Mimikatz -DumpCreds\" or process_command_line contains \"gsecdump -a\" or process_command_line contains \"wce -o\" or process_command_line contains \"procdump -ma lsass.exe\" or process_command_line contains \"ntdsutil*ac i ntds*ifm*create full\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Credential Dumping - Process Access",
        "description": "Checks for execution of MITRE ATT&CK T1003",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 10 and target_process_path contains \"C:\\\\Windows\\\\system32\\\\lsass.exe\" and (process_granted_access contains \"0x1010\" or process_granted_access contains \"0x1410\" or process_granted_access contains \"0x147a\" or process_granted_access contains \"0x143a\") and process_call_trace contains \"C:\\\\Windows\\\\SYSTEM32\\\\ntdll.dll\" and process_call_trace contains \"C:\\\\Windows\\\\system32\\\\KERNELBASE.dll\" and process_call_trace contains \"|UNKNOWN(*)\" ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Credential Dumping - Registry",
        "description": "Checks for execution of MITRE ATT&CK T1003",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and process_path !contains \"C:\\\\WINDOWS\\\\system32\\\\lsass.exe\" and (registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Authentication\\\\Credential Provider\\\\\" or registry_key_path contains \"\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\\" or registry_key_path contains \"\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SecurityProviders\\\\\" or registry_key_path contains \"\\\\Control\\\\SecurityProviders\\\\WDigest\\\\\") and registry_key_path !contains \"\\\\Lsa\\\\RestrictRemoteSamEventThrottlingWindow\" ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Credential Dumping - Registry Save",
        "description": "Checks for execution of MITRE ATT&CK T1003",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"reg.exe\" and (process_command_line contains \"*save*HKLM\\\\sam*\" or process_command_line contains \"*save*HKLM\\\\system*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Winlogon Helper DLL",
        "description": "Checks for execution of MITRE ATT&CK T1004",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\user_nameinit\\\\\" or registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\\\\\" or registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\\\\\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "System Service Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1007",
        "severity": "Medium",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"net.exe\" or process_path contains \"tasklist.exe\" or process_path contains \"sc.exe\" or process_path contains \"wmic.exe\") and (file_directory contains \"net.exe\\\" start\" or file_directory contains \"tasklist.exe\\\" /SVC\" and file_directory contains \"sc.exe\\\" query\" or file_directory contains \"wmic.exe\\\" service where\") ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Query Registry - Network",
        "description": "Checks for execution of MITRE ATT&CK T1012",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and process_path contains \"reg.exe\" and process_command_line contains \"reg query\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Query Registry - Process",
        "description": "Checks for execution of MITRE ATT&CK T1012",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"reg.exe\" and process_command_line contains \"reg query\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Local Port Monitor",
        "description": "Checks for execution of MITRE ATT&CK T1013",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and registry_key_path contains \"\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Print\\\\Monitors\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Accessibility features",
        "description": "Checks for execution of MITRE ATT&CK T1015",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_parent_path contains\"winlogon.exe\" and (process_path contains \"sethc.exe\" or process_path contains \"utilman.exe\" or process_path contains \"osk.exe\" or process_path contains \"magnify.exe\" or process_path contains \"displayswitch.exe\" or process_path contains \"narrator.exe\" or process_path contains \"atbroker.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Accessibility Features - Registry",
        "description": "Checks for execution of MITRE ATT&CK T1015",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and registry_key_path contains \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\*\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Remote System Discovery - Network",
        "description": "Checks for execution of MITRE ATT&CK T1018",
        "severity": "Medium",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"net.exe\" and file_directory contains \"config\") or (process_command_line contains \"ipconfig.exe\" or process_command_line contains \"netsh.exe\" or process_command_line contains \"arp.exe\" or process_command_line contains \"nbtstat.exe\") ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Remote System Discovery - Network",
        "description": "Checks for execution of MITRE ATT&CK T1018",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and (process_path contains \"net.exe\" or process_path contains \"ping.exe\") and (process_command_line contains \"view\" or process_command_line contains \"ping\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Remote System Discovery - Process",
        "description": "Checks for execution of MITRE ATT&CK T1018",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (process_path contains \"net.exe\" or process_path contains \"ping.exe\") and (process_command_line contains \"view\" or process_command_line contains \"ping\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Obfuscated Files or Information",
        "description": "Checks for execution of MITRE ATT&CK T1027",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"certutil.exe\" and process_command_line contains \"encode\") or process_command_line contains \"ToBase64String\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Remote Management",
        "description": "Checks for execution of MITRE ATT&CK T1028",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"wsmprovhost.exe\" or process_path contains \"winrm.cmd\") and (process_command_line contains \"Enable-PSRemoting -Force\" or process_command_line contains \"Invoke-Command -computer_name\" or process_command_line contains \"wmic*node*process call create\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Modify Existing Service",
        "description": "Checks for execution of MITRE ATT&CK T1031",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"sc.exe\" or process_path contains \"powershell.exe\" or process_path contains \"cmd.exe\") and process_command_line contains \"*sc*config*binpath*\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "System Owner/User Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1033",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"whoami.exe\" or process_command_line contains \"whoami\" or file_directory contains \"useraccount get /ALL\" or process_path contains \"qwinsta.exe\" or process_path contains \"quser.exe\" or process_path contains \"systeminfo.exe\") ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Masquerading - Extension",
        "description": "Checks for execution of MITRE ATT&CK T1036",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \".doc.\" or process_path contains \".docx.\" or process_path contains \".xls.\" or process_path contains \".xlsx.\" or process_path contains \".pdf.\" or process_path contains \".rtf.\" or process_path contains \".jpg.\" or process_path contains \".png.\" or process_path contains \".jpeg.\" or process_path contains \".zip.\" or process_path contains \".rar.\" or process_path contains \".ppt.\" or process_path contains \".pptx.\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Masquerading - Location",
        "description": "Checks for execution of MITRE ATT&CK T1036",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 11 and (process_path contains \"SysWOW64\" or process_path contains \"System32\" or process_path contains \"AppData\" or process_path contains \"Temp\") and (file_name contains \".exe\" or file_name contains \".dll\" or file_name contains \".bat\" or file_name contains \".com\" or file_name contains \".ps1\" or file_name contains \".py\" or file_name contains \".js\" or file_name contains \".vbs\" or file_name contains \".hta\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Logon Scripts",
        "description": "Checks for execution of MITRE ATT&CK T1037",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_command_line contains \"*REG*ADD*HKCU\\\\Environment*UserInitMprLogonScript*\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Network Sniffing",
        "description": "Checks for execution of MITRE ATT&CK T1040",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"tshark.exe\" or process_path contains \"windump.exe\" or process_path contains \"logman.exe\" or process_path contains \"tcpdump.exe\" or process_path contains \"wprui.exe\" or process_path contains \"wpr.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Change Default File Association",
        "description": "Checks for execution of MITRE ATT&CK T1042",
        "severity": "Medium",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"\\\\SOFTWARE\\\\Classes\\\\\" or registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\GlobalAssocChangedCounter\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "File System Permissions Weakness",
        "description": "Checks for execution of MITRE ATT&CK T1044",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 7 and (module_loaded contains \"\\\\Temp\\\\\" or module_loaded contains \"C:\\\\Users\\\\\" or driver_signature_status !contains \"Valid\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Management Instrumentation - Instances of an Active Script Event Consumer - FileAccess",
        "description": "Checks for execution of MITRE ATT&CK T1047",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 11 and process_command_line contains \"C:\\\\WINDOWS\\\\system32\\\\wbem\\\\scrcons.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Management Instrumentation - Instances of an Active Script Event Consumer - Process",
        "description": "Checks for execution of MITRE ATT&CK T1047",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_parent_command_line contains \"C:\\\\Windows\\\\System32\\\\svchost.exe\" or process_command_line contains \"C:\\\\WINDOWS\\\\system32\\\\wbem\\\\scrcons.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Management Instrumentation - Process",
        "description": "Checks for execution of MITRE ATT&CK T1047",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and (process_path contains \"wmic.exe\" or process_command_line contains \"wmic\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Management Instrumentation - Process",
        "description": "Checks for execution of MITRE ATT&CK T1047",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_parent_command_line contains \"wmiprvse.exe\" or process_path contains \"wmic.exe\" or process_command_line contains \"wmic\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "WMI command execution",
        "description": "Checks for execution of MITRE ATT&CK T1047",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 20 and wmi_consumer_type contains \"Command Line\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "System Network Connections Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1049",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"net.exe\" or process_path contains \"netstat.exe\") and (process_command_line contains \"*net* use*\" or process_command_line contains \"*net* sessions*\" or process_command_line contains \"*net* file*\" or process_command_line contains \"*netstat*\") or process_command_line contains \"*Get-NetTCPConnection*\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "New Service - Process",
        "description": "Checks for execution of MITRE ATT&CK T1050",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"sc.exe\" or process_path contains \"powershell.exe\" or process_path contains \"cmd.exe\") and (process_command_line contains \"*New-Service*BinaryPathName*\" or process_command_line contains \"*sc*create*binpath*\" or process_command_line contains \"*Get-WmiObject*Win32_Service*create*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Scheduled Task - FileAccess",
        "description": "Checks for execution of MITRE ATT&CK T1053",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 11 and process_command_line contains \"C:\\\\WINDOWS\\\\system32\\\\svchost.exe\" or file_name contains \"C:\\\\Windows\\\\System32\\\\Tasks\\\\\" or file_name contains \"C:\\\\Windows\\\\Tasks\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Scheduled Task - Process",
        "description": "Checks for execution of MITRE ATT&CK T1053",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"taskeng.exe\" or process_path contains \"schtasks.exe\" or (process_path contains \"svchost.exe\" and process_parent_command_line != \"C:\\\\Windows\\\\System32\\\\services.exe\"))",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Indicator Blocking - Driver unloaded",
        "description": "Checks for execution of MITRE ATT&CK T1054",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"fltmc.exe\" or process_command_line contains \"*fltmc*unload*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Indicator Blocking - Sysmon registry edited from other source",
        "description": "Checks for execution of MITRE ATT&CK T1054",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and  (registry_key_path contains \"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\SysmonDrv\\\\*\" or registry_key_path contains \"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Sysmon\\\\*\" or registry_key_path contains \"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Sysmon64\\\\*\") and (process_path !contains \"Sysmon64.exe\" or process_path !contains \"Sysmon.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Process Injection - Process",
        "description": "Checks for execution of MITRE ATT&CK T1055",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_command_line contains \"*Invoke-DllInjection*\" or process_command_line contains \"C:\\\\windows\\\\sysnative\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Process Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1075",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"tasklist.exe\" or process_command_line contains \"Get-Process\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Command-Line Interface",
        "description": "Checks for execution of MITRE ATT&CK T1059",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"cmd.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Registry Run Keys or Start Folder",
        "description": "Checks for execution of MITRE ATT&CK T1060",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run*\" or registry_key_path contains \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\*Shell Folders\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Security Software Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1063",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"netsh.exe\" or process_path contains \"reg.exe\" or process_path contains \"tasklist.exe\") and (process_command_line contains \"*reg* query*\" or process_command_line contains \"*tasklist *\" or process_command_line contains \"*netsh*\" or process_command_line contains \"*fltmc*|*findstr*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Permission Groups Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1069",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where process_path contains \"net\" and (file_directory contains \"user\" or file_directory contains \"group\" or file_directory contains \"localgroup\") ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Permission Groups Discovery - Process",
        "description": "Checks for execution of MITRE ATT&CK T1069",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"net.exe\" and (process_command_line contains \"*net* user*\" or process_command_line contains \"*net* group*\" or process_command_line contains \"*net* localgroup*\" or process_command_line contains \"*get-localgroup*\" or process_command_line contains \"*get-ADPrinicipalGroupMembership*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Indicator removal on host",
        "description": "Checks for execution of MITRE ATT&CK T1070",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where process_path contains \"wevtutil\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Data Staged - Process",
        "description": "Checks for execution of MITRE ATT&CK T1074",
        "severity": "Medium",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"DownloadString\" and process_command_line contains \"Net.WebClient\") or (process_command_line contains \"New-Object\" and process_command_line contains \"IEX\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Remote Desktop Protocol - Process",
        "description": "Checks for execution of MITRE ATT&CK T1076",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and(process_path contains \"tscon.exe\" or process_path contains \"mstsc.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Remote Desktop Protocol - Process",
        "description": "Checks for execution of MITRE ATT&CK T1076",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (process_path contains \"LogonUI.exe\" or registry_key_path contains \"\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows NT\\\\Terminal Services\\\\\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Admin Shares - Network",
        "description": "Checks for execution of MITRE ATT&CK T1077",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and process_path contains \"net.exe\" and (process_command_line contains \"use\" or process_command_line contains \"session\" or process_command_line contains \"file\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Admin Shares - Process",
        "description": "Checks for execution of MITRE ATT&CK T1077",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"net.exe\" or process_path contains \"powershell.exe\") and ((process_command_line contains \"*net* use*$\" or process_command_line contains \"*net* session*$\" or process_command_line contains \"*net* file*$\") or process_command_line contains \"*New-PSDrive*root*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Windows Admin Shares - Process - Created",
        "description": "Checks for execution of MITRE ATT&CK T1077",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"net.exe\" and process_command_line contains \"net share\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Credentials in Files",
        "description": "Checks for execution of MITRE ATT&CK T1081",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"*findstr* /si pass*\" or process_command_line contains \"*select-string -Pattern pass*\" or process_command_line contains \"*list vdir*/text:password*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "System Information Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1082",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains\"sysinfo.exe\" or process_path contains \"reg.exe\") and process_command_line contains \"reg*query HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\Disk\\\\Enum\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Rundll32",
        "description": "Checks for execution of MITRE ATT&CK T1085",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_parent_path contains \"\\\\rundll32.exe\" or process_path contains \"rundll32.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "PowerShell",
        "description": "Checks for execution of MITRE ATT&CK T1086",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"powershell.exe\" or process_path contains \"powershell_ise.exe\" or process_path contains \"psexec.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "PowerShell Downloads - Process",
        "description": "Checks for execution of MITRE ATT&CK T1086",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"*.Download*\" or process_command_line contains \"*Net.WebClient*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Account Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1087",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"net.exe\" or process_path contains \"powershell.exe\") and (process_command_line contains \"*net* user*\" or process_command_line contains \"*net* group*\" or process_command_line contains \"*net* localgroup*\" or process_command_line contains \"cmdkey*\\\\/list*\" or process_command_line contains \"*get-localuser*\" or process_command_line contains \"*get-localgroupmembers*\" or process_command_line contains \"*get-aduser*\" or process_command_line contains \"query*user*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Bypass User Account Control - Process",
        "description": "Checks for execution of MITRE ATT&CK T1088",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_parent_command_line contains \"eventvwr.exe\" or process_parent_command_line contains \"fodhelper.exe\" or process_path contains \"ShellRunas.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Bypass User Account Control - Registry",
        "description": "Checks for execution of MITRE ATT&CK T1088",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"*\\\\mscfile\\\\shell\\\\open\\\\command\\\\*\" or registry_key_path contains \"*\\\\ms-settings\\\\shell\\\\open\\\\command\\\\*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Disabling Security Tools - Service stopped",
        "description": "Checks for execution of MITRE ATT&CK T1089",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"net.exe\" or process_path contains \"sc.exe\") and file_directory contains \"stop\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Process Hollowing",
        "description": "Checks for execution of MITRE ATT&CK T1093",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and ((process_path contains \"smss.exe\" and process_parent_command_line !contains \"smss.exe\") or (process_path contains \"csrss.exe\" and (process_parent_command_line !contains \"smss.exe\" and process_parent_command_line !contains \"svchost.exe\")) or (process_path contains \"wininit.exe\" and process_parent_command_line !contains \"smss.exe\") or (process_path contains \"winlogon.exe\" and process_parent_command_line !contains \"smss.exe\") or (process_path contains \"lsass.exe\" and process_parent_command_line !contains \"wininit.exe\") or (process_path contains \"LogonUI.exe\" and (process_parent_command_line !contains \"winlogon.exe\" and process_parent_command_line !contains \"wininit.exe\")) or (process_path contains \"services.exe\" and process_parent_command_line !contains \"wininit.exe\") or (process_path contains \"spoolsv.exe\" and process_parent_command_line !contains \"services.exe\") or (process_path contains \"taskhost.exe\" and (process_parent_command_line !contains \"services.exe\" and process_parent_command_line !contains \"svchost.exe\")) or (process_path contains \"taskhostw.exe\" and (process_parent_command_line !contains \"services.exe\" and process_parent_command_line !contains \"svchost.exe\")) or (process_path contains \"userinit.exe\" and (process_parent_command_line !contains \"dwm.exe\" and process_parent_command_line !contains \"winlogon.exe\"))) | extend AccountCustomEntity = UserName | extend HostCustomEntity = Computer | extend FileHashCustomEntity = hash_sha256",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "NTFS File Attributes",
        "description": "Checks for execution of MITRE ATT&CK T1096",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"fsutil.exe\" and process_command_line contains \"*usn*deletejournal*\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "AppInit DLLs",
        "description": "Checks for execution of MITRE ATT&CK T1103",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Appinit_Dlls\\\\\" or registry_key_path contains \"\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Appinit_Dlls\\\\\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "File Deletion",
        "description": "Checks for execution of MITRE ATT&CK T1107",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"*remove-item*\" or process_command_line contains \"vssadmin*Delete Shadows /All /Q*\" or process_command_line contains \"*wmic*shadowcopy delete*\" or process_command_line contains \"*wbdadmin* delete catalog -q*\" or process_command_line contains \"*bcdedit*bootstatuspolicy ignoreallfailures*\" or process_command_line contains \"*bcdedit*recoveryenabled no*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Modify Registry",
        "description": "Checks for execution of MITRE ATT&CK T1112",
        "severity": "Medium",
        "enabled": "true",
        "query": "Sysmon | where process_path contains \"reg.exe\" and file_directory contains \"reg.exe\\\" query\" ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Clipboard Data",
        "description": "Checks for execution of MITRE ATT&CK T1115",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"clip.exe\" or process_command_line contains \"*Get-Clipboard*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Bypassing Application Whitelisting with Regsvr32",
        "description": "Checks for execution of MITRE ATT&CK T1117",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"regsvr32.exe\" or process_path contains \"rundll32.exe\" or process_path contains \"certutil.exe\") or process_command_line contains \"scrobj.dll\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Regsvr32",
        "description": "Checks for execution of MITRE ATT&CK T1117",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and (process_parent_path contains \"\\\\regsvr32.exe\" or process_path contains \"\\\\regsvr32.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "InstallUtil",
        "description": "Checks for execution of MITRE ATT&CK T1118",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and (process_path contains \"InstallUtil.exe\" or process_command_line contains \"\\\\/logfile= \\\\/LogToConsole=false \\\\/U\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Regsvcs/Regasm",
        "description": "Checks for execution of MITRE ATT&CK T1121",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and (process_path contains \"regsvcs.exe\" or process_path contains \"regasm.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Component Object Model Hijacking",
        "description": "Checks for execution of MITRE ATT&CK T1122",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and registry_key_path contains \"\\\\Software\\\\Classes\\\\CLSID\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Audio Capture",
        "description": "Checks for execution of MITRE ATT&CK T1115",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"SoundRecorder.exe\" or process_command_line contains \"*Get-AudioDevice*\" or process_command_line contains \"*WindowsAudioDevice-Powershell-Cmdlet*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "System Time Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1124",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"*\\\\net.exe\" and process_command_line contains \"*net* time*\") or process_path contains \"w32tm.exe\" or process_command_line contains \"*Get-Date*\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Network Share Connection Removal",
        "description": "Checks for execution of MITRE ATT&CK T1126",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"net.exe\" and process_command_line contains \"net delete\") or process_command_line contains \"Remove-SmbShare\" or process_command_line contains \"Remove-FileShare\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Trusted Developer Utilities",
        "description": "Checks for execution of MITRE ATT&CK T1127",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"MSBuild.exe\" or process_path contains \"msxsl.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Netsh Helper DLL - Registry",
        "description": "Checks for execution of MITRE ATT&CK T1128",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and registry_key_path contains \"*\\\\SOFTWARE\\\\Microsoft\\\\Netsh\\\\*\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Netsh Helper DLL - Process",
        "description": "Checks for execution of MITRE ATT&CK T1128",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"netsh.exe\" and process_command_line contains \"*helper*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Install Root Certificate",
        "description": "Checks for execution of MITRE ATT&CK T1130",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and process_path !contains \"svchost.exe\" and (registry_key_path contains \"*\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\Root\\\\Certificates\\\\*\" or registry_key_path contains \"*\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\Certificates\\\\*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Authentication Package",
        "description": "Checks for execution of MITRE ATT&CK T1131",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"*\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\*\") and (process_path !contains \"C:\\\\WINDOWS\\\\system32\\\\lsass.exe\" or process_path !contains \"C:\\\\Windows\\\\system32\\\\svchost.exe\" or process_path !contains \"C:\\\\Windows\\\\system32\\\\services.exe\") ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Network Share Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1135",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where process_path contains \"net.exe\" and (process_command_line contains \"view\" or process_command_line contains \"share\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Network Share Discovery - Process",
        "description": "Checks for execution of MITRE ATT&CK T1135",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"net.exe\" and (process_command_line contains \"net view\" or process_command_line contains \"net share\")) or process_command_line contains \"get-smbshare -Name\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Create Account",
        "description": "Checks for execution of MITRE ATT&CK T1136",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"New-LocalUser\" or process_command_line contains \"net user add\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Application Shimming - FileAccess",
        "description": "Checks for execution of MITRE ATT&CK T1138",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 11 and file_name contains \"C:\\\\Windows\\\\AppPatch\\\\Custom\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Application Shimming - Process",
        "description": "Checks for execution of MITRE ATT&CK T1138",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"sdbinst.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Application Shimming - Registry",
        "description": "Checks for execution of MITRE ATT&CK T1138",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\InstalledSDB\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Deobfuscate/Decode Files or Information",
        "description": "Checks for execution of MITRE ATT&CK T1140",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"certutil.exe\" and process_command_line contains \"decode\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Clear Command History",
        "description": "Checks for execution of MITRE ATT&CK T1146",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"*rm (Get-PSReadlineOption).HistorySavePath*\" or process_command_line contains \"*del (Get-PSReadlineOption).HistorySavePath*\" or process_command_line contains \"*Set-PSReadlineOption -HistorySaveStyle SaveNothing*\" or process_command_line contains \"*Remove-Item (Get-PSReadlineOption).HistorySavePath*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Hidden Files and Directories",
        "description": "Checks for execution of MITRE ATT&CK T1158",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"attrib.exe\" and (process_command_line contains \"+h\" or process_command_line contains \"+s\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Hidden Files and Directories - VSS",
        "description": "Checks for execution of MITRE ATT&CK T1158",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"*\\\\VolumeShadowCopy*\\\\*\" or process_command_line contains \"*\\\\VolumeShadowCopy*\\\\*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "MSHTA - FileAccess",
        "description": "Checks for execution of MITRE ATT&CK T1170",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 11 or EventID == 15) and file_name contains \".hta\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "MSHTA - Network",
        "description": "Checks for execution of MITRE ATT&CK T1170",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and (process_command_line contains \"mshta.exe\" or process_parent_command_line contains \"mshta.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "MSHTA - Process",
        "description": "Checks for execution of MITRE ATT&CK T1170",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"mshta.exe\" or process_parent_command_line contains \"mshta.exe\") ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Hooking",
        "description": "Checks for execution of MITRE ATT&CK T1179",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"mavinject.exe\" or process_command_line contains \"/INJECTRUNNING\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Screensaver",
        "description": "Checks for execution of MITRE ATT&CK T1180",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"*\\\\Control Panel\\\\Desktop\\\\SCRNSAVE.EXE\") and (process_parent_command_line !contains \"explorer.exe\" or process_path !contains \"rundll32.exe\" or process_command_line !contains \"*shell32.dll,Control_RunDLL desk.cpl,ScreenSaver,*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "AppCert DLLs",
        "description": "Checks for execution of MITRE ATT&CK T1182",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and registry_key_path contains \"\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\AppCertDlls\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Image File Execution Options Injection",
        "description": "Checks for execution of MITRE ATT&CK T1183",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\\" or registry_key_path contains \"\\\\Wow6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Forced Authentication",
        "description": "Checks for execution of MITRE ATT&CK T1187",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 11 and (file_name contains \".lnk\" or file_name contains \".scf\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "CMSTP",
        "description": "Checks for execution of MITRE ATT&CK T1191",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"CMSTP.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Control Panel Items - Process",
        "description": "Checks for execution of MITRE ATT&CK T1196",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"control \\\\/name\"  or process_command_line contains \"rundll32 shell32.dll,Control_RunDLL\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Control Panel Items - Registry",
        "description": "Checks for execution of MITRE ATT&CK T1196",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and (registry_key_path contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\ControlPanel\\\\NameSpace\" or registry_key_path contains \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Controls Folder\\\\*\\\\Shellex\\\\PropertySheetHandlers\\\\\" or registry_key_path contains \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Control Panel\\\\\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "BITS Jobs - Network",
        "description": "Checks for execution of MITRE ATT&CK T1197",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and process_path contains \"bitsadmin.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "BITS Jobs - Process",
        "description": "Checks for execution of MITRE ATT&CK T1197",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_path contains \"bitsamin.exe\" or process_command_line contains \"Start-BitsTransfer\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Password Policy Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1201",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 11 and (process_command_line contains \"net accounts\" or process_command_line contains \"net accounts \\\\/domain\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Indirect Command Execution",
        "description": "Checks for execution of MITRE ATT&CK T1202",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_parent_command_line contains \"pcalua.exe\" or process_path contains \"pcalua.exe\" or process_path contains \"bash.exe\" or process_path contains \"forfiles.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Time Providers",
        "description": "Checks for execution of MITRE ATT&CK T1209",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where (EventID == 12 or EventID == 13 or EventID == 14) and registry_key_path contains \"\\\\System\\\\CurrentControlSet\\\\Services\\\\W32Time\\\\TimeProviders\\\\\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Credentials in Registry",
        "description": "Checks for execution of MITRE ATT&CK T1214",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"reg query HKLM \\\\/f password \\\\/t REG_SZ \\\\/s\" or process_command_line contains \"reg query HKCU \\\\/f password \\\\/t REG_SZ \\\\/s\" or process_command_line contains \"Get-UnattendedInstallFile\" or process_command_line contains \"Get-Webconfig\" or process_command_line contains \"Get-ApplicationHost\" or process_command_line contains \"Get-SiteListPassword\" or process_command_line contains \"Get-CachedGPPPassword\" or process_command_line contains \"Get-RegistryAutoLogon\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Signed Script Proxy Execution",
        "description": "Checks for execution of MITRE ATT&CK T1216",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where process_path contains \"cscript\" or process_path contains \"wscript\" or process_path contains \"certutil\" or process_path contains \"jjs\" and file_directory !contains \" /nologo \\\"MonitorKnowledgeDiscovery.vbs\\\"\" ",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Browser Bookmark Discovery",
        "description": "Checks for execution of MITRE ATT&CK T1217",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"*firefox*places.sqlite*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Signed Binary Proxy Execution - Network",
        "description": "Checks for execution of MITRE ATT&CK T1218",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 3 and (process_path contains \"certutil.exe\" or process_command_line contains \"*certutil*script\\\\:http\\\\[\\\\:\\\\]\\\\/\\\\/*\" or process_path contains \"*\\\\replace.exe\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Signed Binary Proxy Execution - Process",
        "description": "Checks for execution of MITRE ATT&CK T1218",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and (process_command_line contains \"mavinject*\\\\/injectrunning\" or process_command_line contains \"mavinject32*\\\\/injectrunning*\" or process_command_line contains \"*certutil*script\\\\:http\\\\[\\\\:\\\\]\\\\/\\\\/*\" or process_command_line contains \"*certutil*script\\\\:https\\\\[\\\\:\\\\]\\\\/\\\\/*\" or process_command_line contains \"*msiexec*http\\\\[\\\\:\\\\]\\\\/\\\\/*\" or process_command_line contains \"*msiexec*https\\\\[\\\\:\\\\]\\\\/\\\\/*\")",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      },
      {
        "displayName": "Compiled HTML File",
        "description": "Checks for execution of MITRE ATT&CK T1223",
        "severity": "High",
        "enabled": "true",
        "query": "Sysmon | where EventID == 1 and process_path contains \"hh.exe\"",
        "queryFrequency": "1H",
        "queryPeriod": "1H",
        "triggerOperator": "GreaterThan",
        "triggerThreshold": "1",
        "suppressionDuration": "6H",
        "suppressionEnabled": "false"
      }
    ]
  }
